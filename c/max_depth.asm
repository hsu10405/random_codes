.ORIG x6000
NULL .FILL X0000
;struct
;local var
;R5
;R7
;ret val
;parameter
;MAIN <-R6
FUNCTION
LDR R0, R6, #0 ;LOADS MAIN LOCAL VARIABLE
ADD R6, R6, #-1 ;MOVE TO PARAMETER
STR R0, R6, #0




MAX_DEPTH
;save R5, R7
ADD R6, R6, #-4
STR R5, R6, #1
STR R7, R6, #2

ADD R5, R6, #0
ADD R6, R6 #-1

;WORK

LDR R0, R5, #4 ;LOAD THE PARAMETER
LD  R1, NULL

ADD R1, R0, R1
BRn TEAR
ADD R0, R0, #1
STR R0, R6, #0
JSR FUNCTION ;RECURSION FOR LDEPTH
STR R1, R5, #0
ADD R0, R0, #2
ADD R6, R6, #-5
STR R0, R6, #0
JSR FUNCTION ;RECURSION FOR RDEPTH
STR R1, R5, #-1
ADD R6, R6, #-5

;RETURN 
LDR R1, R5, #0 ;LOAD LDEPTH
LDR R2, R5, #-1 ;LOAD RDEPTH

NOT R2, R2
ADD R2, R2, #1 ;FLIP RDEPTH

ADD R3, R1, R2
BRnz RETRIGHT
ADD R1, R1, #1
STR R1, R5, #3
BRnzp TEAR

RETRIGHT
ADD R2, R2 #-1
NOT R2, R2
ADD R2, R2, #1
STR R2, R5, #3

TEAR

;RESTORE R5, R7

ADD R6, R6, #3
LDR R5, R6, #0
LDR R7, R6, #1

;R6 POINTS AT RETVAL
ADD R6, R6, #2

RET
